<!DOCTYPE html>
<html lang="en">
<head>
  <title>Cholera Visualization</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<div id="choleraDeathTablePlot"></div>
<div id="choleraDeathLinePlot"></div>
<div id="naplesCholeraAgeSexTablePlot"></div>
<div id="naplesCholeraAgeSexBarPlot"></div>
<div id="ukCensusTablePlot"></div>
<div id="ukCensusBarPlot"></div>
<div id="ukCensusPiePlot"></div>
<div id="ukCensusPieTotalPlot"></div>

<script type="text/javascript">
  Plotly.d3.tsv('./choleraDeaths.tsv', (data) => {
    const headerValues = Object.keys(data[0]);
    const cellValues= [];
    const dateValue = [];
    const attackPerValue = [];
    const deathPerValue = [];
    const totalAttackValue = [];
    const totalDeathValue = [];

    for(let i = 0; i < data.length; i++) {
      const obj = Object.values(data[i]);
      dateValue.push(obj[0]);
      attackPerValue.push(obj[1]);
      deathPerValue.push(obj[2]);
      totalAttackValue.push(obj[3]);
      totalDeathValue.push(obj[4]);
    }

    cellValues.push(dateValue);
    cellValues.push(attackPerValue);
    cellValues.push(deathPerValue);
    cellValues.push(totalAttackValue);
    cellValues.push(totalDeathValue);

    const choleraDeathTable = [{
      type: 'table',
      header: {
        values: headerValues,
        align: "center",
        line: { width: 1, color: 'black' },
        fill: { color: "grey" },
        font: { family: "Arial", size: 12, color: "white" }
      },
      cells: {
        values: cellValues,
        align: ["center", "right", "right", "right", "right"],
        line: { color: "black", width: 1 },
        font: { family: "Arial", size: 11, color: ["black"] }
      }
    }];

    const choleraDeathTableLayout = {
      title: "Cholera Attacks and Deaths by Date",
      paperColor: "#F5F5F5"
    };

    const attacksPerLine = {
      x: dateValue,
      y: attackPerValue,
      type: 'scatter',
      name: 'Attacks per Day'
    };

    const deathsPerLine = {
      x: dateValue,
      y: deathPerValue,
      type: 'scatter',
      name: 'Deaths per Day'
    };

    const totalAttacksLine = {
      x: dateValue,
      y: totalAttackValue,
      type: 'scatter',
      name: 'Total Attacks'
    };

    const totalDeathsLine = {
      x: dateValue,
      y: totalDeathValue,
      type: 'scatter',
      name: 'Total Deaths'
    };

    const choleraDeathLines = [attacksPerLine, deathsPerLine, totalAttacksLine, totalDeathsLine];

    const choleraDeathLineLayout = {
      title: "Cholera Attacks and Deaths by Date",
      paperColor: "#F5F5F5",
      plotColor: "#F5F5F5",
      yaxis: {
        title: 'Number of Attacks/Deaths'
      }
    };

    const choleraDeathLinePlot = document.getElementById('choleraDeathLinePlot');
    Plotly.plot(choleraDeathLinePlot, choleraDeathLines, choleraDeathTableLayout);

    const choleraDeathTablePlot = document.getElementById('choleraDeathTablePlot');
    Plotly.plot(choleraDeathTablePlot, choleraDeathTable, choleraDeathLineLayout);
  });

  Plotly.d3.tsv('./naplesCholeraAgeSexData.tsv', (data) => {
    const headerValues = Object.keys(data[0]);
    const cellValues= [];
    const ageValue = [];
    const maleDeathValue = [];
    const femaleDeathValue = [];

    for(let i = 0; i < data.length; i++) {
      const obj = Object.values(data[i]);
      ageValue.push(obj[0]);
      maleDeathValue.push(obj[1]);
      femaleDeathValue.push(obj[2]);
    }

    cellValues.push(ageValue);
    cellValues.push(maleDeathValue);
    cellValues.push(femaleDeathValue);

    const naplesCholeraAgeSexTable = [{
      type: 'table',
      header: {
        values: headerValues,
        align: "center",
        line: { width: 1, color: 'black' },
        fill: { color: "grey" },
        font: { family: "Arial", size: 12, color: "white" }
      },
      cells: {
        values: cellValues,
        align: ["center", "right", "right"],
        line: { color: "black", width: 1 },
        font: { family: "Arial", size: 11, color: ["black"] }
      }
    }];

    const naplesCholeraAgeSexTableLayout = {
      title: "Naples Cholera Deaths Table by Age and Sex",
      paperColor: "#f5f5f5"
    };

    const naplesCholeraAgeSexBar = [{
      type: 'bar',
      name: 'Male',
      x: ageValue,
      y: maleDeathValue,
      marker: {
        color: 'rgb(30, 180, 50)'
      }
    }, {
      type: 'bar',
      name: 'Female',
      x: ageValue,
      y: femaleDeathValue,
      marker: {
        color: 'rgb(80, 30, 150)'
      }
    }];

    const naplesCholeraAgeSexBarLayout = {
      title: 'Naples Cholera Deaths by Age and Sex',
      barMode: 'grouped',
      paperColor: "#f5f5f5",
      plotColor: "#f5f5f5",
      xAxis: {
        title: 'Age Ranges',
      },
      yAxis: {
        title: 'Male and Females'
      }
    }

    const naplesCholeraAgeSexTablePlot = document.getElementById('naplesCholeraAgeSexTablePlot');
    Plotly.plot(naplesCholeraAgeSexTablePlot, naplesCholeraAgeSexTable, naplesCholeraAgeSexTableLayout);

    const naplesCholeraAgeSexBarPlot = document.getElementById('naplesCholeraAgeSexBarPlot');
    Plotly.plot(naplesCholeraAgeSexBarPlot, naplesCholeraAgeSexBar, naplesCholeraAgeSexBarLayout);
  });

  Plotly.d3.csv('./UKcensus1851.csv', (data) => {
    const headerValues = Object.keys(data[0]);
    const cellValues= [];
    const ageValue = [];
    const maleValue = [];
    const femaleValue = [];
    const sexTotalValues = [];
    const sexValue = ['Female', 'Male'];
    let maleValueTotal = 0;
    let femaleValueTotal = 0;

    for(let i = 0; i < data.length; i++) {
      const obj = Object.values(data[i]);
      ageValue.push(obj[0]);
      maleValue.push(obj[1]);
      femaleValue.push(obj[2]);
    }

    for(let i = 0; i < maleValue.length; i++) {
      maleValueTotal += parseInt(maleValue[i], 10);
    }

    for(let i = 0; i < femaleValue.length; i++) {
      femaleValueTotal += parseInt(femaleValue[i], 10);
    }

    cellValues.push(ageValue);
    cellValues.push(maleValue);
    cellValues.push(femaleValue);
    sexTotalValues.push(maleValueTotal);
    sexTotalValues.push(femaleValueTotal);

    const ukCensusTable = [{
      type: 'table',
      header: {
        values: headerValues,
        align: "center",
        line: { width: 1, color: 'black' },
        fill: { color: "grey" },
        font: { family: "Arial", size: 12, color: "white" }
      },
      cells: {
        values: cellValues,
        align: ["center", "right", "right"],
        line: { color: "black", width: 1 },
        font: { family: "Arial", size: 11, color: ["black"] }
      }
    }];

    const ukCensusTableLayout = {
      title: "UK Census Table by Age and Sex",
      paperColor: "#f5f5f5"
    };

    const ukCensusBar = [{
      type: 'bar',
      name: 'Male',
      x: ageValue,
      y: maleValue,
      marker: {
        color: 'rgb(30, 30, 180)'
      }
    }, {
      type: 'bar',
      name: 'Female',
      x: ageValue,
      y: femaleValue,
      marker: {
        color: 'rgb(210, 80, 30)'
      }
    }];

    const ukCensusBarLayout = {
      title: 'UK Census Bar Chart by Age and Sex',
      barMode: 'grouped',
      paperColor: "#f5f5f5",
      plotColor: "#f5f5f5",
      xAxis: {
        title: 'Age Ranges',
      },
      yAxis: {
        title: 'Male and Females'
      }
    }

    const ukCensusPie = [{
      type: 'pie',
      values: maleValue,
      labels: ageValue,
      name: 'Men',
      domain: {
        x: [0.15, 0.48]
      },
      hoverInfo: 'label+percent+name',
      textPosition: 'outside',
      marker: {
        colors: ['rgb(0, 255, 0)', 'rgb(255, 0, 0)', 'rgb(0, 0, 255)', 'rgb(255, 255, 0)', 'rgb(255, 0, 255)',
          'rgb(0, 255, 255)', 'rgb(100, 0, 0)', 'rgb(0, 0, 100)', 'rgb(0, 100, 0)']
      }
    },
      {
        type: 'pie',
        values: femaleValue,
        labels: ageValue,
        name: 'Women',
        domain: {
          x: [0.49, 0.82]
        },
        hoverInfo: 'label+percent+name',
        textPosition: 'outside',
        marker: {
          colors: ['rgb(0, 255, 0)', 'rgb(255, 0, 0)', 'rgb(0, 0, 255)', 'rgb(255, 255, 0)', 'rgb(255, 0, 255)',
            'rgb(0, 255, 255)', 'rgb(100, 0, 0)', 'rgb(0, 0, 100)', 'rgb(0, 100, 0)']
        }
      }];

    const ukCensusPieTotal = [
    {
      type: 'pie',
          values: sexTotalValues,
        labels: sexValue,
        name: 'Men vs Women',
        domain: {
      x: [0.34, 0.67]
    },
      hoverInfo: 'label+percent+name',
          textPosition: 'outside',
        marker: {
      colors: ['rgb(0, 255, 0)', 'rgb(255, 0, 0)', 'rgb(0, 0, 255)', 'rgb(255, 255, 0)', 'rgb(255, 0, 255)',
        'rgb(0, 255, 255)', 'rgb(100, 0, 0)', 'rgb(0, 0, 100)', 'rgb(0, 100, 0)']
    }
    }];

    const ukCensusPieLayout = {
      title: 'Age Breakdown for Each Sex',
      titleFont: { size: 26 },
      paperColor: "#f5f5f5",
      plotColor: "#f5f5f5",
      annotations: [
        {
          text: 'Men',
          showArrow: false,
          x: 0.30,
          y: 1,
          font: { size: 16 }
        },{
          text: 'Women',
          showArrow: false,
          x: 0.65,
          y: 1,
          font: { size: 16 }
        }
      ]
    };

    const ukCensusPieTotalLayout = {
      title: 'Total Census Breakdown by Sex',
      titleFont: { size: 26 },
      paperColor: "#f5f5f5",
      plotColor: "#f5f5f5",
      annotations: [
          {
            text: 'Men vs Women',
            showArrow: true,
            x: 0.5,
            y: 1,
            font: { size: 16 }
          }
      ]
    };

    const ukCensusTablePlot = document.getElementById('ukCensusTablePlot');
    Plotly.plot(ukCensusTablePlot, ukCensusTable, ukCensusTableLayout);

    const ukCensusBarPlot = document.getElementById('ukCensusBarPlot');
    Plotly.plot(ukCensusBarPlot, ukCensusBar, ukCensusBarLayout);

    const ukCensusPiePlot = document.getElementById('ukCensusPiePlot');
    Plotly.plot(ukCensusPiePlot, ukCensusPie, ukCensusPieLayout);

    const ukCensusPieTotalPlot = document.getElementById('ukCensusPieTotalPlot');
    Plotly.plot(ukCensusPieTotalPlot, ukCensusPieTotal, ukCensusPieTotalLayout);
  });

  Plotly.d3.csv('./choleraDeathLocations.csv', (data) => {return data});
  Plotly.d3.csv('./choleraPumpLocations.csv', (data) => {return data});
</script>

</body>
</html>
